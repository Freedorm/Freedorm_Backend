<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.lock.mapper.FreedormLocksMapper">

    <!-- 结果映射 -->
    <resultMap id="FreedormLocksResultMap" type="com.ruoyi.lock.domain.FreedormLock">
        <id property="deviceId" column="device_id" />
        <result property="location" column="location" />
        <result property="createdAt" column="created_at" />
        <result property="updatedAt" column="updated_at" />
    </resultMap>

    <!-- 插入操作 -->
    <insert id="insertFreedormLock" parameterType="com.ruoyi.lock.domain.FreedormLock">
        INSERT INTO freedorm_locks (
        <if test="deviceId != null and deviceId != ''">device_id,</if>
        <if test="location != null and location != ''">location,</if>
        created_at,
        updated_at
        )
        VALUES (
        <if test="deviceId != null and deviceId != ''">#{deviceId},</if>
        <if test="location != null and location != ''">#{location},</if>
        sysdate(),
        sysdate()
        )
    </insert>

    <!-- 更新操作 -->
    <update id="updateFreedormLock" parameterType="com.ruoyi.lock.domain.FreedormLock">
        UPDATE freedorm_locks
        <set>
            <if test="location != null and location != ''">location = #{location},</if>
            updated_at = sysdate()
        </set>
        WHERE device_id = #{deviceId}
    </update>

    <!-- 查询列表 -->
    <select id="selectFreedormLockList" parameterType="com.ruoyi.lock.domain.FreedormLock" resultMap="FreedormLocksResultMap">
        SELECT device_id, location, created_at, updated_at
        FROM freedorm_locks
        <where>
            <if test="deviceId != null and deviceId != ''">
                AND device_id LIKE CONCAT('%', #{deviceId}, '%')
            </if>
            <if test="location != null and location != ''">
                AND location LIKE CONCAT('%', #{location}, '%')
            </if>
            <if test="params.createdAfter != null">
                AND created_at &gt;= #{params.createdAfter}
            </if>
            <if test="params.createdBefore != null">
                AND created_at &lt;= #{params.createdBefore}
            </if>
        </where>
        ORDER BY device_id ASC
    </select>

    <!-- 根据 device_id 查询单个记录 -->
    <select id="selectFreedormLockById" parameterType="String" resultMap="FreedormLocksResultMap">
        SELECT device_id, location, created_at, updated_at
        FROM freedorm_locks
        WHERE device_id = #{deviceId}
    </select>

    <!-- 根据 device_id 删除记录 -->
    <delete id="deleteFreedormLockById" parameterType="String">
        DELETE FROM freedorm_locks
        WHERE device_id = #{deviceId}
    </delete>

    <!-- 根据多个 device_id 删除记录 -->
    <delete id="deleteFreedormLocksByIds" parameterType="java.util.List">
        DELETE FROM freedorm_locks
        WHERE device_id IN
        <foreach collection="list" item="deviceId" open="(" separator="," close=")">
            #{deviceId}
        </foreach>
    </delete>

</mapper>
